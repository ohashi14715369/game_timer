(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{203:function(e,t,n){e.exports=n(445)},208:function(e,t,n){},212:function(e,t,n){},445:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"createTimerOpen",function(){return P}),n.d(a,"createTimerClose",function(){return U}),n.d(a,"createTimerChange",function(){return F}),n.d(a,"createTimerRegister",function(){return q}),n.d(a,"deleteTimer",function(){return H}),n.d(a,"addTimerInstance",function(){return J}),n.d(a,"loadGameTimer",function(){return V}),n.d(a,"showDrawer",function(){return K}),n.d(a,"hideDrawer",function(){return X}),n.d(a,"updateApp",function(){return Y}),n.d(a,"startTimer",function(){return $}),n.d(a,"notifyTimer",function(){return Q}),n.d(a,"stopRinging",function(){return Z});var r=n(0),i=n.n(r),o=n(21),c=n.n(o),s=(n(208),n(37)),u=n(38),l=n(41),m=n(39),d=n(42),f=n(30),p=n(13),h=n(22),b=n.n(h),E=(n(212),n(10)),v="CREATE_TIMER.OPEN",g="CREATE_TIMER.CHANGE",O="CREATE_TIMER.CLOSE",y="CREATE_TIMER.REGISTER",w="GAME_TIMER.DELETE_TIMER",j="GAME_TIMER.ADD_TIMER_INSTANCE",T="GAME_TIMER.REMOVE_TIMER_INSTANCE",I="GAME_TIMER.SHOW_DRAWER",R="GAME_TIMER.HIDE_DRAWER",k="GAME_TIMER.UPDATE_APP",A="GAME_TIMER.LOAD_AUDIO",M="GAME_TIMER.START_TIMER",C="GAME_TIMER.NOTIFY_TIMER",_="GAME_TIMER.STOP_RINGING",N=n(187),D=n(202),S=n(188),x=n.n(S),G=null,B=function(){null==G&&(G=x()())},W=function(e,t){B(),function(e,t){if(e.buffer)t(e.buffer,e);else if(e instanceof ArrayBuffer)t(e,e);else if(e instanceof Blob){var n=new FileReader;n.onload=function(){t(n.result,e)},n.readAsArrayBuffer(e)}else{if("string"!==typeof e)throw new TypeError("Unknown type");var a=new XMLHttpRequest;a.responseType="arraybuffer",a.onload=function(){t(a.response,e)},a.open("GET",e),a.send()}}(e,function(e){G.decodeAudioData(e,function(e){var n=G.createBufferSource();n.buffer=e,n.connect(G.destination),t(n)})})},L=new N.a("TIMER"),P=function(){return{type:v}},U=function(){return{type:O}},F=function(e,t){return{type:g,key:e,value:t}},q=function(e){var t=e.label,n=e.hour,a=e.minute,r=e.second,i=e.sound,o={};if(t||(o=Object(E.a)({},o,{second:"Not empty"})),n+a+r===0&&(o=Object(E.a)({},o,{second:"Not zero"})),Object.keys(o).length>0)throw new D.a(Object(E.a)({},o,{_error:!0}));return function(e){var o=new Date,c=i&&{sound:{type:i.type,data:i}},s=i&&i.name;L.put({_id:o,_attachments:c,label:t,hour:n,minute:a,second:r,soundName:s}).then(function(t){L.get(t.id).then(function(t){z(e,t)})})}},H=function(e){return function(t){t(Z(e)),L.get(e).then(function(e){return L.remove(e)}).then(t({type:w,instanceId:e}))}},J=function(e){return Object(E.a)({type:j},e)},V=function(){return function(e){L.allDocs({include_docs:!0}).then(function(t){console.log("load from db"),b.a.forEach(t.rows,function(t){return z(e,t.doc)})})}},z=function(e,t){var n=t._id,a=t.label,r=t.hour,i=t.minute,o=t.second,c=t.soundName;c?L.getAttachment(n,"sound").then(function(t){W(t,function(t){e(J({instanceId:n,label:a,hour:r,minute:i,second:o,soundName:c,soundSource:t})),e(U())})}):(e(J({instanceId:n,label:a,hour:r,minute:i,second:o,soundName:c,soundSource:null})),e(U()))},K=function(){return{type:I}},X=function(){return{type:R}},Y=function(){return function(e){navigator.serviceWorker.getRegistration().then(function(t){t&&t.unregister(),window.location.reload(!0),e({type:k})})}},$=function(e){return B(),{type:M}},Q=function(e){return function(t,n){var a=n().gametimer.timers,r=b.a.find(a,function(t){return t.instanceId===e}),i=!1;r.soundSource&&(i=!0,r.soundSource.start(0)),new Notification(r.label+" was done!",{silent:i}),t({type:C,timer:r})}},Z=function(e){return function(t,n){var a=n().gametimer.timers,r=b.a.find(a,function(t){return t.instanceId===e});r&&r.soundSource&&r.soundSource.stop(),t({type:_,instanceId:e})}},ee=n(67),te=n(192),ne=n.n(te),ae=n(193),re=n.n(ae),ie=n(45),oe=n.n(ie),ce=n(46),se=n.n(ce),ue=n(194),le=n.n(ue),me=n(198),de=n.n(me),fe=n(197),pe=n.n(fe),he=n(195),be=n.n(he),Ee=n(128),ve=n.n(Ee),ge=n(129),Oe=n.n(ge),ye=n(196),we=n.n(ye),je=n(200),Te=n.n(je),Ie=n(199),Re=n.n(Ie),ke=n(48),Ae=n.n(ke),Me=n(60),Ce=n.n(Me),_e=function(e){function t(e){var n;Object(s.a)(this,t),n=Object(l.a)(this,Object(m.a)(t).call(this));var a=Ae()(),r=Ae()(a).add(e.timer.hour,"hours").add(e.timer.minute,"minutes").add(e.timer.second,"seconds"),i=n.getDiff(a,r);return n.state={start:null,end:null,text:n.getText(i),timer:null,millis:i,passed:0},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"start",value:function(){var e=this,t=this.state,n=t.millis,a=t.passed,r=Ae()(),i=Ae()().add(n-a,"milliseconds");this.state.timer&&clearInterval(this.state.timer),this.setState(function(t){return Object(E.a)({},t,{start:r,end:i,timer:setInterval(function(){return e.update()},16)})}),this.props.actions.startTimer(this.props.timer.instanceId)}},{key:"stop",value:function(){if(this.state.timer){var e=this.state.start,t=Ae()(),n=this.getDiff(e,t),a=Math.min(this.state.passed+n,this.state.millis),r=this.getText(this.state.millis-a);clearInterval(this.state.timer),this.setState(function(e){return Object(E.a)({},e,{start:null,end:null,timer:null,passed:a,text:r})})}}},{key:"reset",value:function(){var e=this;this.stop();var t=this.state.millis;this.setState(function(n){return Object(E.a)({},n,{text:e.getText(t),passed:0})})}},{key:"update",value:function(){var e=this,t=Ae()(),n=this.state.end,a=this.getDiff(t,n);a<=0?(this.stop(),this.notify()):this.setState(function(t){return Object(E.a)({},t,{text:e.getText(a)})})}},{key:"getDiff",value:function(e,t){var n=t.diff(e,"milliseconds");return n<0&&(n=0),n}},{key:"getText",value:function(e){var t=e%1e3,n=(e=Math.floor(e/1e3))%60,a=(e=Math.floor(e/60))%60;return("00"+(e=Math.floor(e/60))).slice(-2)+":"+("00"+a).slice(-2)+":"+("00"+n).slice(-2)+"."+("000"+t).slice(-3)}},{key:"delete",value:function(){this.state.timer&&clearInterval(this.state.timer),this.props.actions.deleteTimer(this.props.timer.instanceId)}},{key:"notify",value:function(){this.props.actions.notifyTimer(this.props.timer.instanceId)}},{key:"stopRinging",value:function(){this.props.timer.ringing&&this.props.actions.stopRinging(this.props.timer.instanceId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.timer,r=this.state,o=r.text,c=r.start;return i.a.createElement("div",{onClick:function(){return e.stopRinging()}},i.a.createElement(oe.a,{variant:"subtitle1",gutterBottom:!0},a.label),i.a.createElement(oe.a,{variant:"body1",gutterBottom:!0},o),this.props.timer.soundName?i.a.createElement("div",null,i.a.createElement(Ce.a,null),this.props.timer.soundName):null,i.a.createElement(se.a,{color:"secondary",className:n.button,"aria-label":"start",onClick:function(){return e.start()},disabled:null!=c},i.a.createElement(Ce.a,null,"play_arrow")),i.a.createElement(se.a,{color:"secondary",className:n.button,"aria-label":"stop",onClick:function(){return e.stop()},disabled:null==c},i.a.createElement(Ce.a,null,"pause")),i.a.createElement(se.a,{color:"secondary",className:n.button,"aria-label":"reset",onClick:function(){return e.reset()}},i.a.createElement(Ce.a,null,"replay")),i.a.createElement(se.a,{color:"secondary",className:n.button,"aria-label":"delete",onClick:function(){return e.delete()}},i.a.createElement(Ce.a,null,"delete")))}}]),t}(r.Component);var Ne=Object(ee.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(Object(f.b)(null,function(e){return{actions:Object(p.b)(a,e)}})(_e)),De=n(447),Se=n(446),xe=n(94),Ge=n.n(xe),Be=n(92),We=n(125),Le=n.n(We),Pe=n(127),Ue=n.n(Pe),Fe=n(190),qe=n.n(Fe),He=n(68),Je=n.n(He),Ve=n(93),ze=n.n(Ve),Ke=n(189),Xe=n.n(Ke),Ye=n(126),$e=n.n(Ye),Qe=function(e){var t=e.label,n=e.input,a=e.meta,r=a.touched,o=a.invalid,c=a.error,s=Object(Be.a)(e,["label","input","meta"]);return i.a.createElement(Xe.a,Object.assign({label:t,placeholder:t,error:r&&o,helperText:r&&c},n,s))},Ze=function(e){var t=e.input,n=t.value,a=t.name,r=t.onChange,o=e.label,c=e.meta,s=c.touched,u=c.error,l=(e.classes,e.onFieldChange),m=e.buttonLabel,d=e.accept,f=void 0===d?"*":d,p=e.required,h=void 0!==p&&p,b=e.rootClass,E=void 0===b?"":b;return i.a.createElement(Je.a,{classes:{root:E},required:h,component:"fieldset",error:!(!s||!u)},i.a.createElement($e.a,{component:"legend"},o),i.a.createElement("input",{accept:f,id:a,type:"file",onChange:function(e){e.preventDefault(),r(e.target.files[0]),l&&l(e.target.files[0])},onBlur:function(){}}),i.a.createElement("label",{htmlFor:a},i.a.createElement(Ge.a,{variant:"outlined",component:"span"},m||"\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e")),i.a.createElement("label",null,n&&n.name),s&&u&&i.a.createElement(ze.a,null,u))},et=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.id,e.min),n=e.max,a=e.step,r=e.input,o=e.label,c=e.meta,s=c.touched,u=c.error,l=(e.children,Object(Be.a)(e,["id","min","max","step","input","label","meta","children"]));return i.a.createElement(Je.a,{error:s},i.a.createElement(Le.a,null,o),i.a.createElement(Ue.a,Object.assign({},r,l),b.a.map(b.a.range(t,n,a),function(e){return i.a.createElement(qe.a,{key:e,value:e},("00"+e).slice(-2))})),function(e){var t=e.touched,n=e.error;return t&&n?i.a.createElement(ze.a,null,t&&n):void 0}({touched:s,error:u}))}}]),t}(r.Component);et.defaultProps={step:1};var tt=et,nt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.handleSubmit;return i.a.createElement("form",{onSubmit:e},i.a.createElement("div",null,i.a.createElement(De.a,{name:"label",component:Qe,label:"label"})),i.a.createElement("div",null,i.a.createElement(De.a,{name:"hour",component:tt,props:{min:0,max:99,label:"hour"}}),i.a.createElement(De.a,{name:"minute",component:tt,props:{min:0,max:59,label:"minute"}}),i.a.createElement(De.a,{name:"second",component:tt,props:{min:0,max:59,label:"second"}}),i.a.createElement(De.a,{name:"sound",label:"sound",accept:"audio/*",component:Ze}),i.a.createElement(Ge.a,{type:"submit"},"Register")))}}]),t}(r.Component),at=nt=Object(Se.a)({form:"createTimer",initialValues:{hour:0,minute:0,second:0}})(nt),rt=function(e){function t(e){var n;return Object(s.a)(this,t),n=Object(l.a)(this,Object(m.a)(t).call(this,e)),e.actions.loadGameTimer(),Notification.requestPermission().then(function(e){}),n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.gametimer,n=e.createtimer,a=e.actions,r=e.classes;return i.a.createElement("div",{className:r.root},i.a.createElement(ne.a,{position:"static"},i.a.createElement(re.a,{variant:"dense"},i.a.createElement(se.a,{className:r.menuButton,color:"inherit","aria-label":"Menu",onClick:function(){return a.showDrawer()}},i.a.createElement(le.a,null)),i.a.createElement(oe.a,{variant:"h6",color:"inherit"},"Game Timer"))),i.a.createElement(be.a,{open:t.visibleDrawer,onClose:function(){return a.hideDrawer()}},i.a.createElement("div",{tabIndex:0,role:"button",onClick:function(){return a.hideDrawer()},onKeyDown:function(){return a.hideDrawer()}},i.a.createElement("div",{className:r.list},i.a.createElement(ve.a,null,i.a.createElement(Oe.a,{button:!0,onClick:function(){return a.updateApp()}},i.a.createElement(we.a,{primary:"Update"})))))),b.a.map(t.timers,function(e){return i.a.createElement(Ne,{key:e.instanceId,timer:e})}),i.a.createElement(pe.a,{color:"secondary","aria-label":"Add",className:r.addButton,onClick:function(){return a.createTimerOpen()}},i.a.createElement(de.a,null)),i.a.createElement(Re.a,{onClose:function(){return a.createTimerClose()},"aria-labelledby":"simple-dialog-title",open:n.show},i.a.createElement(Te.a,{id:"simple-dialog-title"},"Create Timer"),i.a.createElement(at,{onSubmit:function(e){return a.createTimerRegister(e)}})))}}]),t}(r.Component);var it=Object(ee.withStyles)(function(e){return{root:{flexGrow:1},menuButton:{marginLeft:-18,marginRight:10},addButton:{position:"absolute",bottom:2*e.spacing.unit,right:2*e.spacing.unit},textField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,width:200},menu:{width:200}}},{withTheme:!0})(Object(f.b)(function(e,t){return{gametimer:e.gametimer,createtimer:e.createtimer}},function(e){return{actions:Object(p.b)(a,e)}})(rt)),ot=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ct(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var st=n(201),ut=n(448),lt=n(91),mt={show:!1,hour:0,minute:0,second:0},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(E.a)({},e,{show:!0,hour:0,minute:0,second:0});case O:return Object(E.a)({},e,{show:!1});case g:return Object(E.a)({},e,Object(lt.a)({},t.key,t.value));case y:return Object(E.a)({},e,{show:!1});default:return Object(E.a)({},e)}},ft={timers:[],visibleDrawer:!1},pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case j:var n=Object.assign({},t);return delete n.type,Object(E.a)({},e,{timers:b.a.concat(e.timers,Object(E.a)({},n,{audioBuffer:null}))});case T:case w:return Object(E.a)({},e,{timers:b.a.chain(e.timers).reject(function(e){return e.instanceId===t.instanceId}).value()});case I:return Object(E.a)({},e,{visibleDrawer:!0});case R:return Object(E.a)({},e,{visibleDrawer:!1});case k:return Object(E.a)({},e);case C:var a=t.timer.instanceId;return Object(E.a)({},e,{timers:b.a.chain(e.timers).map(function(e){return e.instanceId===a?Object(E.a)({},e,{ringing:!0}):e}).value()});case _:var r=t.instanceId;return Object(E.a)({},e,{timers:b.a.chain(e.timers).map(function(e){return e.instanceId===r?Object(E.a)({},e,{ringing:!1}):e}).value()});case A:var i=t.instanceId,o=t.soundSource;return Object(E.a)({},e,{timers:b.a.chain(e.timers).map(function(e){return e.instanceId===i?Object(E.a)({},e,{soundSource:o}):e}).value()});default:return Object(E.a)({},e)}},ht=Object(p.c)({form:ut.a,createtimer:dt,gametimer:pt}),bt=Object(p.d)(ht,Object(p.a)(st.a));c.a.render(i.a.createElement(f.a,{store:bt},i.a.createElement(it,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/game_timer",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/game_timer","/service-worker.js");ot?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ct(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ct(t,e)})}}()}},[[203,1,2]]]);
//# sourceMappingURL=main.d2cea1f5.chunk.js.map